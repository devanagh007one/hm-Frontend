import React, { useEffect } from 'react';
import { useSelector, useDispatch } from 'react-redux';
import { fetchUsers } from '../redux/actions/authActions';
import { fetchAllUsers } from '../redux/actions/alluserGet';

const Infoprofile = () => {
  const darkMode = useSelector((state) => state.theme.darkMode);
  const userData = useSelector((state) => state.auth.userData);
  const { users, error } = useSelector((state) => state.user);

  const dispatch = useDispatch();

  useEffect(() => {
    dispatch(fetchUsers());
    dispatch(fetchAllUsers());
  }, [dispatch]);

  if (!userData) {
    return <div>Loading...</div>;
  }
  // console.log(userData)

  // Filtering users with role "Partner"
  const partnerUsers = users ? users.filter(user => user.roles && user.roles.includes('Partner')) : [];
  const cardClass = `${darkMode ? 'bg-zinc-800 text-zinc-300' : 'bg-slate-100 text-black'}`;

  return (
    <section className='gap-4 flex flex-col w-1/2 '>
      <div className='flex gap-3 h-full'>
        <div
          className={`card flex flex-col w-1/2 overflow-hidden p-5 relative ${cardClass}`}
          style={{
            backgroundSize: 'cover',
            backgroundPosition: 'center',
            backgroundColor: '#D9AA58'
          }}
        >
          <span className='namedash'>{userData?.firstName || 'N/A'} {userData?.lastName || ''}</span>
          <span className='namedash mt-5 w-[30px]'>{userData?.roles?.[0] || 'No Role'}</span>
          {userData?.image && (
            <img
              src={`${process.env.REACT_APP_STATIC_API_URL}${userData.image.replace('/root/happme_adminuser_management', '')}`}
              alt="Notification"
              className='w-[150px] absolute ml-[200px] mnaitoimg'
            />
          )}

          <div className='pl-[20px] pr-[20px] pt-[15px] h-1/4 absolute bottom-0 left-0 w-full bg-[#FFFFFF] flex justify-between'>
            <div>
              <svg width="50" height="50" viewBox="0 0 50 50" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect width="50" height="50" rx="6" fill="#D9D9D9" />
              </svg>
            </div>
            <div className='flex flex-col desination gap-2'>
              <span>{userData?.department || 'No Department'}</span>
              <span>{userData?.company || 'No Company'}</span>
            </div>
          </div>
        </div>
        <div className='flex flex-col justify-between w-1/2 gap-4 '>
          <div className={`card h-1/2 p-4 gap-2 flex flex- ${cardClass}`}>
            <div className='flex flex-col'>
              <div className='text-2xl'>Clients</div>
              <div className='nubbox text-3xl'>{users ? users.length : 0}</div>
            </div>
            <div className='relative mt-[30px]'>
              <svg width="131" height="85" viewBox="0 0 131 85" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M1 58.79C1 58.79 18.278 41.3612 33.7874 38.7803C45.5807 36.8178 53.0316 49.9207 64.9169 48.4033C83.3206 46.0538 86.2426 22.9832 104.45 19.7236C114.599 17.9066 130.454 19.7235 130.454 19.7235" stroke="#BABD27" stroke-width="1.09244" stroke-linecap="round" />
                <path d="M34.3338 38.72C18.8244 41.2931 1.54639 58.6688 1.54639 58.6688V84.4622H131V19.7211C131 19.7211 115.146 17.9096 104.996 19.7211C86.789 22.9708 83.848 47.066 65.4443 49.4084C53.5589 50.9212 46.1271 36.7634 34.3338 38.72Z" fill="url(#paint0_linear_3251_77)" />
                <path d="M46.092 16.689V7.987H47.859V16.689H46.092ZM42.615 13.231V11.464H51.336V13.231H42.615ZM53.9752 18V16.309C53.9752 15.9163 54.0766 15.511 54.2792 15.093C54.4819 14.6623 54.7669 14.2317 55.1342 13.801C55.5142 13.3703 55.9576 12.965 56.4642 12.585L58.7822 10.913C59.0736 10.7103 59.3396 10.476 59.5802 10.21C59.8336 9.944 60.0362 9.66533 60.1882 9.374C60.3402 9.07 60.4162 8.77233 60.4162 8.481C60.4162 8.11367 60.3212 7.778 60.1312 7.474C59.9539 7.17 59.6942 6.92933 59.3522 6.752C59.0229 6.57467 58.6176 6.486 58.1362 6.486C57.7056 6.486 57.3192 6.57467 56.9772 6.752C56.6479 6.91667 56.3756 7.13833 56.1602 7.417C55.9449 7.69567 55.7929 7.99967 55.7042 8.329L53.4432 7.911C53.5699 7.303 53.8359 6.73933 54.2412 6.22C54.6592 5.688 55.1912 5.26367 55.8372 4.947C56.4959 4.63033 57.2432 4.472 58.0792 4.472C59.0166 4.472 59.8272 4.643 60.5112 4.985C61.2079 5.327 61.7399 5.802 62.1072 6.41C62.4872 7.00533 62.6772 7.68933 62.6772 8.462C62.6772 9.24733 62.4619 9.95667 62.0312 10.59C61.6132 11.2107 61.0242 11.806 60.2642 12.376L58.1362 13.953C57.7182 14.257 57.3762 14.5863 57.1102 14.941C56.8442 15.283 56.6606 15.6503 56.5592 16.043H62.8482V18H53.9752ZM65.5707 18L75.0137 4.7H77.2177L67.7177 18H65.5707ZM75.1847 18.304C74.5894 18.304 74.0637 18.1647 73.6077 17.886C73.1517 17.6073 72.7907 17.221 72.5247 16.727C72.2714 16.233 72.1447 15.6757 72.1447 15.055C72.1447 14.4217 72.2714 13.8643 72.5247 13.383C72.778 12.9017 73.1327 12.5217 73.5887 12.243C74.0574 11.9643 74.5894 11.825 75.1847 11.825C75.78 11.825 76.3057 11.9643 76.7617 12.243C77.2177 12.5217 77.5724 12.9017 77.8257 13.383C78.0917 13.8643 78.2247 14.4217 78.2247 15.055C78.2247 15.6757 78.0917 16.233 77.8257 16.727C77.5724 17.221 77.2177 17.6073 76.7617 17.886C76.3057 18.1647 75.78 18.304 75.1847 18.304ZM75.1847 16.803C75.6027 16.803 75.9447 16.6383 76.2107 16.309C76.4767 15.9797 76.6097 15.5617 76.6097 15.055C76.6097 14.561 76.4767 14.1493 76.2107 13.82C75.9447 13.478 75.6027 13.307 75.1847 13.307C74.7667 13.307 74.4184 13.478 74.1397 13.82C73.8737 14.1493 73.7407 14.561 73.7407 15.055C73.7407 15.5617 73.8737 15.9797 74.1397 16.309C74.4184 16.6383 74.7667 16.803 75.1847 16.803ZM67.6607 10.875C67.078 10.875 66.5524 10.7357 66.0837 10.457C65.6277 10.1783 65.273 9.792 65.0197 9.298C64.7664 8.804 64.6397 8.24667 64.6397 7.626C64.6397 6.99267 64.7664 6.43533 65.0197 5.954C65.273 5.47267 65.6277 5.09267 66.0837 4.814C66.5524 4.53533 67.0844 4.396 67.6797 4.396C68.275 4.396 68.8007 4.53533 69.2567 4.814C69.7127 5.09267 70.0674 5.47267 70.3207 5.954C70.574 6.43533 70.7007 6.99267 70.7007 7.626C70.7007 8.24667 70.574 8.804 70.3207 9.298C70.0674 9.792 69.7064 10.1783 69.2377 10.457C68.7817 10.7357 68.256 10.875 67.6607 10.875ZM67.6607 9.374C68.0914 9.374 68.4397 9.20933 68.7057 8.88C68.9717 8.55067 69.1047 8.13267 69.1047 7.626C69.1047 7.132 68.9717 6.72033 68.7057 6.391C68.4397 6.06167 68.0914 5.897 67.6607 5.897C67.2427 5.897 66.9007 6.06167 66.6347 6.391C66.3687 6.72033 66.2357 7.132 66.2357 7.626C66.2357 8.13267 66.3687 8.55067 66.6347 8.88C66.9007 9.20933 67.2427 9.374 67.6607 9.374Z" fill="#BABD27" />
                <g clip-path="url(#clip0_3251_77)">
                  <path d="M59.855 30.7498L63.4275 27.1772M63.4275 27.1772L67 30.7498M63.4275 27.1772V39.681" stroke="#BABD27" stroke-width="1.78625" stroke-linecap="round" stroke-linejoin="round" />
                </g>
                <defs>
                  <linearGradient id="paint0_linear_3251_77" x1="66.2733" y1="18.916" x2="74.0973" y2="87.2037" gradientUnits="userSpaceOnUse">
                    <stop stop-color="#BABD27" stop-opacity="0.11" />
                    <stop offset="0.988823" stop-color="#BABD27" stop-opacity="0" />
                  </linearGradient>
                  <clipPath id="clip0_3251_77">
                    <rect width="14.2017" height="14.2017" fill="white" transform="translate(54.5298 22.7397)" />
                  </clipPath>
                </defs>
              </svg>

            </div>
          </div>
          <div className={`card h-1/2 p-4 gap-2 flex flex- ${cardClass}`}>
            <div className='flex flex-col'>
              <div className='text-2xl'>Partners</div>
              <div className='nubbox text-3xl'>{partnerUsers.length}</div>
            </div>
            <div className='relative ml-[-20px] mt-[30px] '>
              <svg width="131" height="85" viewBox="0 0 131 85" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M1 58.79C1 58.79 18.278 41.3612 33.7874 38.7803C45.5807 36.8178 53.0316 49.9207 64.9169 48.4033C83.3206 46.0538 86.2426 22.9832 104.45 19.7236C114.599 17.9066 130.454 19.7235 130.454 19.7235" stroke="#BABD27" stroke-width="1.09244" stroke-linecap="round" />
                <path d="M34.3338 38.72C18.8244 41.2931 1.54639 58.6688 1.54639 58.6688V84.4622H131V19.7211C131 19.7211 115.146 17.9096 104.996 19.7211C86.789 22.9708 83.848 47.066 65.4443 49.4084C53.5589 50.9212 46.1271 36.7634 34.3338 38.72Z" fill="url(#paint0_linear_3251_77)" />
                <path d="M46.092 16.689V7.987H47.859V16.689H46.092ZM42.615 13.231V11.464H51.336V13.231H42.615ZM53.9752 18V16.309C53.9752 15.9163 54.0766 15.511 54.2792 15.093C54.4819 14.6623 54.7669 14.2317 55.1342 13.801C55.5142 13.3703 55.9576 12.965 56.4642 12.585L58.7822 10.913C59.0736 10.7103 59.3396 10.476 59.5802 10.21C59.8336 9.944 60.0362 9.66533 60.1882 9.374C60.3402 9.07 60.4162 8.77233 60.4162 8.481C60.4162 8.11367 60.3212 7.778 60.1312 7.474C59.9539 7.17 59.6942 6.92933 59.3522 6.752C59.0229 6.57467 58.6176 6.486 58.1362 6.486C57.7056 6.486 57.3192 6.57467 56.9772 6.752C56.6479 6.91667 56.3756 7.13833 56.1602 7.417C55.9449 7.69567 55.7929 7.99967 55.7042 8.329L53.4432 7.911C53.5699 7.303 53.8359 6.73933 54.2412 6.22C54.6592 5.688 55.1912 5.26367 55.8372 4.947C56.4959 4.63033 57.2432 4.472 58.0792 4.472C59.0166 4.472 59.8272 4.643 60.5112 4.985C61.2079 5.327 61.7399 5.802 62.1072 6.41C62.4872 7.00533 62.6772 7.68933 62.6772 8.462C62.6772 9.24733 62.4619 9.95667 62.0312 10.59C61.6132 11.2107 61.0242 11.806 60.2642 12.376L58.1362 13.953C57.7182 14.257 57.3762 14.5863 57.1102 14.941C56.8442 15.283 56.6606 15.6503 56.5592 16.043H62.8482V18H53.9752ZM65.5707 18L75.0137 4.7H77.2177L67.7177 18H65.5707ZM75.1847 18.304C74.5894 18.304 74.0637 18.1647 73.6077 17.886C73.1517 17.6073 72.7907 17.221 72.5247 16.727C72.2714 16.233 72.1447 15.6757 72.1447 15.055C72.1447 14.4217 72.2714 13.8643 72.5247 13.383C72.778 12.9017 73.1327 12.5217 73.5887 12.243C74.0574 11.9643 74.5894 11.825 75.1847 11.825C75.78 11.825 76.3057 11.9643 76.7617 12.243C77.2177 12.5217 77.5724 12.9017 77.8257 13.383C78.0917 13.8643 78.2247 14.4217 78.2247 15.055C78.2247 15.6757 78.0917 16.233 77.8257 16.727C77.5724 17.221 77.2177 17.6073 76.7617 17.886C76.3057 18.1647 75.78 18.304 75.1847 18.304ZM75.1847 16.803C75.6027 16.803 75.9447 16.6383 76.2107 16.309C76.4767 15.9797 76.6097 15.5617 76.6097 15.055C76.6097 14.561 76.4767 14.1493 76.2107 13.82C75.9447 13.478 75.6027 13.307 75.1847 13.307C74.7667 13.307 74.4184 13.478 74.1397 13.82C73.8737 14.1493 73.7407 14.561 73.7407 15.055C73.7407 15.5617 73.8737 15.9797 74.1397 16.309C74.4184 16.6383 74.7667 16.803 75.1847 16.803ZM67.6607 10.875C67.078 10.875 66.5524 10.7357 66.0837 10.457C65.6277 10.1783 65.273 9.792 65.0197 9.298C64.7664 8.804 64.6397 8.24667 64.6397 7.626C64.6397 6.99267 64.7664 6.43533 65.0197 5.954C65.273 5.47267 65.6277 5.09267 66.0837 4.814C66.5524 4.53533 67.0844 4.396 67.6797 4.396C68.275 4.396 68.8007 4.53533 69.2567 4.814C69.7127 5.09267 70.0674 5.47267 70.3207 5.954C70.574 6.43533 70.7007 6.99267 70.7007 7.626C70.7007 8.24667 70.574 8.804 70.3207 9.298C70.0674 9.792 69.7064 10.1783 69.2377 10.457C68.7817 10.7357 68.256 10.875 67.6607 10.875ZM67.6607 9.374C68.0914 9.374 68.4397 9.20933 68.7057 8.88C68.9717 8.55067 69.1047 8.13267 69.1047 7.626C69.1047 7.132 68.9717 6.72033 68.7057 6.391C68.4397 6.06167 68.0914 5.897 67.6607 5.897C67.2427 5.897 66.9007 6.06167 66.6347 6.391C66.3687 6.72033 66.2357 7.132 66.2357 7.626C66.2357 8.13267 66.3687 8.55067 66.6347 8.88C66.9007 9.20933 67.2427 9.374 67.6607 9.374Z" fill="#BABD27" />
                <g clip-path="url(#clip0_3251_77)">
                  <path d="M59.855 30.7498L63.4275 27.1772M63.4275 27.1772L67 30.7498M63.4275 27.1772V39.681" stroke="#BABD27" stroke-width="1.78625" stroke-linecap="round" stroke-linejoin="round" />
                </g>
                <defs>
                  <linearGradient id="paint0_linear_3251_77" x1="66.2733" y1="18.916" x2="74.0973" y2="87.2037" gradientUnits="userSpaceOnUse">
                    <stop stop-color="#BABD27" stop-opacity="0.11" />
                    <stop offset="0.988823" stop-color="#BABD27" stop-opacity="0" />
                  </linearGradient>
                  <clipPath id="clip0_3251_77">
                    <rect width="14.2017" height="14.2017" fill="white" transform="translate(54.5298 22.7397)" />
                  </clipPath>
                </defs>
              </svg>

            </div>
          </div>
        </div>
      </div>
    </section>
  );
}

export default Infoprofile;
